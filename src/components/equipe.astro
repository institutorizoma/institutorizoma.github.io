---
import { Picture } from "astro:assets";
import Container from "@components/container.astro";
import Sectionhead from "@components/sectionhead.astro";
import AnaCarolinaImg from "assets/ana-carolina.png";
import JoaoImg from "assets/joao.png";
import KamilaImg from "assets/kamila.png";
import KarolinaImg from "assets/karolina.png";
import LaraImg from "assets/lara.png";

const teamMembers = [
  {
    id: "ana-carolina",
    name: "Ana Carolina Simão",
    title: "Psicóloga",
    credentials: "(CRP 06/118379)",
    image: AnaCarolinaImg,
    alt: "Ana Carolina Simão - Psicóloga especializada em psicanálise contemporânea e saúde mental",
    details: [
      "Formada em Psicologia com ênfase em Clínica pela PUC-Campinas, **Mestre em Ciências - Saúde Mental pela Unicamp**, possui 9 anos de experiência na clínica privada e no **trabalho com grupos** em instituições.",
      "Seu percurso também passa pelo aprimoramento em saúde mental (Instituto A Casa) com casos mais graves, cursos sobre psicanálise de grupo (Instituto Gerar de Psicanálise) e aperfeiçoamento em **psicanálise contemporânea.**",
      "Trabalha em consultório particular com questões que atravessam nosso tempo e nossa cultura, atingindo principalmente **adolescentes e adultos com ansiedade, transição de carreira, síndrome do imigrante e estresse pós-traumático.**"
    ]
  },
  {
    id: "joao",
    name: "João Paulo Zerbinati",
    title: "Psicólogo",
    credentials: "(CRP 06/119389)",
    image: JoaoImg,
    alt: "Dr. João Paulo Zerbinati - Psicólogo com doutorado em Psicologia pela USP",
    details: [
      "Psicólogo com mais de 10 anos de experiência clínica. Graduado pela PUC-Campinas com ênfase em clínica psicanalítica, **mestre pela UNESP e doutor em Psicologia pela USP**.",
      "Atua com ênfase no desenvolvimento emocional e na saúde mental pela perspectiva da **psicanálise contemporânea** (Freud e Winnicott). Mantém estudos avançados em sociedades psicanalíticas ligadas à Associação Psicanalítica Internacional.",
      "Sua trajetória combina prática clínica com produção científica nas áreas de **Psicanálise, Psicologia, Gênero e Sexualidade**."
    ]
  },
  {
    id: "kamila",
    name: "Dra. Kamila Baruque Bignotto",
    title: "Médica Psiquiatra",
    credentials: "(CRM-SP162517 | RQE 66011-1)",
    image: KamilaImg,
    alt: "Dra. Kamila Baruque Bignotto - Médica Psiquiatra especialista em psiquiatria da infância e adolescência",
    details: [
      "Médica Psiquiatra formada pela SES-Sorocaba em **Psiquiatria da infância e adolescência pela UNICAMP**.",
      "Desde 2018 atua como psiquiatra colaboradora da UNICAMP, no serviço de Gênero e sexualidade humana e supervisão de médicos residentes da universidade. Tem **especialização em medicina canabinóide**.",
      "Com mais de 12 anos de experiência na medicina, está apta a identificar e tratar, de **forma integral e personalizada, as diversas necessidades psiquiátricas de crianças, adolescentes e adultos**."
    ]
  },
  {
    id: "karolina",
    name: "Dra. Karoline Bignotto",
    title: "Médica de Família",
    credentials: "(CRM-SP 197.489)",
    image: KarolinaImg,
    alt: "Dra. Karoline Bignotto - Médica de Família especialista em medicina de família e comunidade",
    details: [
      "Médica há 6 anos, graduada pela Universidade Federal do Rio de Janeiro, **especialista em medicina de família e comunidade** pelo programa de residência da Prefeitura de São Bernardo do Campo (RQE 110.230), **pós-graduada em gestão em saúde pelo Ensino Albert Einstein**.",
      "Atendimento de todos os ciclos de vida, auxiliando o indivíduo a acessar um **acompanhamento de saúde preventivo, integral**, coordenado, baseado em evidencia e centrado em suas especificidades."
    ]
  },
  {
    id: "lara",
    name: "Lara Sousa Blanes",
    title: "Psicóloga",
    credentials: "(CRP 06/120257)",
    image: LaraImg,
    alt: "Lara Sousa Blanes - Psicóloga existencial fenomenológica especialista em redução de danos",
    details: [
      "Psicóloga existencial fenomenológica, sanitarista e redutora de danos. Com formação pela PUCCAMP (2013), atua há mais de 10 anos na **saúde mental**, com experiência em **atendimentos clínicos, uso de substâncias psicoativas e políticas públicas**. Participou da desinstitucionalização dos hospitais psiquiátricos de Sorocaba e trabalhou na organização do RAPS em Cerquilho, em parceria com o Ministério da Saúde.",
      "Foi Psicóloga do CAPS AD III por 8 anos, onde também atuou na formação de profissionais. Tem formação em Justiça Restaurativa, **medicina psicodélica, cannabis medicinal e antropologia da saúde**.",
      "Atualmente, integra o núcleo clínica da Associação MentalCann e atende em consultório particular."
    ]
  }
];
---

<div id="equipe" class="w-full py-8 bg-rizoma-bege" style="position: relative; z-index: 10;">
  <Container>
    <Sectionhead>
      <Fragment slot="title">Nossa equipe</Fragment>
      <Fragment slot="desc">Profissionais especializados e experientes trabalhando juntos pelo seu bem-estar.</Fragment>
    </Sectionhead>

    <div class="equipe-grid">
      <div class="grid md:grid-cols-3 gap-10 mx-auto max-w-4xl mt-4">
        {teamMembers.map((member) => (
          <div class="group" data-member-id={member.id}>
            <!-- Mobile layout: flex row with smaller image and text on right -->
            <div class="flex md:hidden gap-4 items-center cursor-pointer team-member-trigger">
              <div class="w-36 h-36 flex-shrink-0">
                <Picture
                  src={member.image}
                  alt={member.alt}
                  sizes="144px"
                  width={144}
                  height={144}
                  class="w-full h-full rounded-md transition group-hover:-translate-y-1 group-hover:shadow-xl bg-white object-cover object-center"
                />
              </div>
              <div class="flex-1">
                <h2 class="text-lg font-bold text-gray-900">{member.name}</h2>
                <h2 class="text-slate-700">{member.title}</h2>
                <h4 class="text-sm text-slate-600">{member.credentials}</h4>
              </div>
            </div>

            <!-- Mobile accordion content -->
            <div class="team-member-details md:hidden hidden mt-4 p-4 bg-white rounded-lg shadow-lg border-l-4 border-rizoma-green">
              <div class="space-y-3">
                {member.details.map((detail) => (
                  <p class="text-sm leading-relaxed text-slate-800" set:html={detail.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')} />
                ))}
              </div>
              <div class="mt-4 flex justify-between items-center">
                {member.id === 'ana-carolina' && (
                  <a href="/profissionais/ana-carolina" class="px-4 py-2 bg-rizoma-green hover:bg-rizoma-green-darker text-white text-sm font-medium rounded transition-colors">
                    Saiba mais
                  </a>
                )}
                {member.id !== 'ana-carolina' && <div></div>}
                <button class="text-rizoma-green hover:text-rizoma-green-darker text-sm font-medium close-details">
                  Fechar detalhes
                </button>
              </div>
            </div>
          </div>
        ))}
      </div>

      <!-- Desktop accordion content - spans full width -->
      {teamMembers.map((member) => (
        <div class="team-member-details-desktop hidden md:block hidden mt-8 p-6 bg-white rounded-lg shadow-lg border-l-4 border-rizoma-green mx-auto max-w-4xl" data-member-id={member.id}>
          <h3 class="text-2xl font-bold text-gray-800 mb-4">{member.name} - {member.title}</h3>
          <div class="grid md:grid-cols-2 gap-6">
            <div>
              <Picture
                src={member.image}
                alt={member.alt}
                sizes="(max-width: 800px) 100vw, 300px"
                width={300}
                height={300}
                class="w-full max-w-sm rounded-md bg-white object-cover object-center aspect-square mx-auto"
              />
            </div>
            <div class="space-y-4">
              {member.details.map((detail) => (
                <p class="text-base leading-relaxed text-slate-800" set:html={detail.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')} />
              ))}
                  {member.id === 'ana-carolina' && (
                  <a href="/profissionais/ana-carolina" class="inline-block mt-3 px-4 py-2 bg-rizoma-green hover:bg-rizoma-green-darker text-white text-sm font-medium rounded transition-colors">
                    Saiba mais
                  </a>
                )}
            </div>
          </div>
        </div>
      ))}
    </div>
</Container>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const triggers = document.querySelectorAll('.team-member-trigger');
  const mobileCloseButtons = document.querySelectorAll('.close-details');
  const desktopCloseButtons = document.querySelectorAll('.close-details-desktop');

  triggers.forEach(trigger => {
    trigger.addEventListener('click', function() {
      const memberCard = this.closest('[data-member-id]');
      const memberId = memberCard.getAttribute('data-member-id');

      // For mobile: get the mobile details within the same card
      const mobileDetails = memberCard.querySelector('.team-member-details');

      // For desktop: get the desktop details by matching member ID
      const desktopDetails = document.querySelector(`.team-member-details-desktop[data-member-id="${memberId}"]`);

      // Close all other open details first
      document.querySelectorAll('.team-member-details:not(.hidden)').forEach(openDetail => {
        if (openDetail !== mobileDetails) {
          openDetail.classList.add('hidden');
        }
      });

      document.querySelectorAll('.team-member-details-desktop:not(.hidden)').forEach(openDetail => {
        if (openDetail !== desktopDetails) {
          openDetail.classList.add('hidden');
        }
      });

      // Toggle current details based on screen size
      if (window.innerWidth >= 768) { // md breakpoint
        desktopDetails.classList.toggle('hidden');
      } else {
        mobileDetails.classList.toggle('hidden');
      }
    });
  });

  // Mobile close buttons
  mobileCloseButtons.forEach(button => {
    button.addEventListener('click', function(e) {
      e.stopPropagation();
      const details = this.closest('.team-member-details');
      details.classList.add('hidden');
    });
  });

  // Desktop close buttons
  desktopCloseButtons.forEach(button => {
    button.addEventListener('click', function(e) {
      e.stopPropagation();
      const details = this.closest('.team-member-details-desktop');
      details.classList.add('hidden');
    });
  });
});
</script>